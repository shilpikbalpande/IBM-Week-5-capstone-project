{
    "cells": [
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "                                        IBM Applied Data Science Capstone Course by Coursera\n                                                  Week 5  Report\n                                        Opening an Italian Restaurant in Chicago\n\n                                        1. Build a dataframe of neighborhoods in Chicago, USA by web scraping using beutifulSoup package. \n                                        2. Get the geographical coordinates of the localities in chicago using Geocode package\n                                        3. Fetch data for venues for all localities/neighbouhoods using Foursquare API\n                                        4. Explore and cluster the neighborhoods\n                                        5. Select the best cluster to open a new indian restaurant"
        },
        {
            "cell_type": "code",
            "execution_count": 36,
            "metadata": {},
            "outputs": [
                {
                    "name": "stdout",
                    "output_type": "stream",
                    "text": "     index                         Neighborhood\n0        0                          Albany Park\n1        1                      Altgeld Gardens\n2        2                        Andersonville\n3        3                       Archer Heights\n4        4                        Armour Square\n5        5                              Ashburn\n6        6                      Ashburn Estates\n7        7                       Auburn Gresham\n8        8                          Avalon Park\n9        9                             Avondale\n10      10                     Avondale Gardens\n11      11                    Back of the Yards\n12      12                      Belmont Central\n13      13                      Belmont Gardens\n14      14                      Belmont Heights\n15      15                      Belmont Terrace\n16      16                              Beverly\n17      17                         Beverly View\n18      18                        Beverly Woods\n19      19                             Big Oaks\n20      20                             Boystown\n21      21                          Bowmanville\n22      22                             Brainerd\n23      23                            Brickyard\n24      24                           Bridgeport\n25      25                        Brighton Park\n26      26                          Bronzeville\n27      27                             Bucktown\n28      28                        Budlong Woods\n29      29                           Buena Park\n30      30                             Burnside\n31      31                        Cabrini\u2013Green\n32      32                      Calumet Heights\n33      33                          Canaryville\n34      34                      Central Station\n35      35                              Chatham\n36      36                         Chicago Lawn\n37      37                            Chinatown\n38      38                     Chrysler Village\n39      39                       Clarendon Park\n40      40                        Clearing East\n41      41                        Clearing West\n42      42                Cottage Grove Heights\n43      43                               Cragin\n44      44                            Crestline\n45      45                       Dearborn Homes\n46      46                        Dearborn Park\n47      47                         Douglas Park\n48      48                              Dunning\n49      49                         East Beverly\n50      50                         East Chatham\n51      51                   East Garfield Park\n52      52                       East Hyde Park\n53      53                          East Pilsen\n54      54                            East Side\n55      55                         East Village\n56      56                           Eden Green\n57      57                            Edgebrook\n58      58                            Edgewater\n59      59                      Edgewater Beach\n60      60                       Edgewater Glen\n61      61                          Edison Park\n62      62                            Englewood\n63      63                             Fernwood\n64      64                           Fifth City\n65      65                            Ford City\n66      66                          Forest Glen\n67      67                          Fuller Park\n68      68                Fulton River District\n69      69                            Gage Park\n70      70                             Galewood\n71      71                              The Gap\n72      72                       Garfield Ridge\n73      73                       Gladstone Park\n74      74                           Gold Coast\n75      75                          Golden Gate\n76      76                         Goose Island\n77      77                       Graceland West\n78      78                      Grand Boulevard\n79      79                       Grand Crossing\n80      80               Greater Grand Crossing\n81      81                            Greektown\n82      82                              Gresham\n83      83                       Groveland Park\n84      84                        Hamilton Park\n85      85                          Hanson Park\n86      86                     Heart of Chicago\n87      87                            Hegewisch\n88      88                              Hermosa\n89      89                       Hollywood Park\n90      90                         Homan Square\n91      91                        Humboldt Park\n92      92                            Hyde Park\n93      93            Illinois Medical District\n94      94                          Irving Park\n95      95                         Irving Woods\n96      96                           The Island\n97      97                              Jackowo\n98      98               Jackson Park Highlands\n99      99                       Jefferson Park\n100    100                               K-Town\n101    101                          Kelvyn Park\n102    102                         Kennedy Park\n103    103                           Kensington\n104    104                              Kenwood\n105    105                        Kilbourn Park\n106    106                      Kosciuszko Park\n107    107                         Lake Meadows\n108    108                            Lake View\n109    109                       Lake View East\n110    110                  Lakewood / Balmoral\n111    111                      LeClaire Courts\n112    112  Legends South (Robert Taylor Homes)\n113    113                             Lilydale\n114    114                         Lincoln Park\n115    115                       Lincoln Square\n116    116                     Lithuanian Plaza\n117    117                         Little Italy\n118    118                       Little Village\n119    119                         Logan Square\n120    120                       Longwood Manor\n121    121                             The Loop\n122    122                      Lower West Side\n123    123                               Loyola\n124    124                     Magnificent Mile\n125    125                         Margate Park\n126    126                       Marquette Park\n127    127                      Marshall Square\n128    128                             Marynook\n129    129                              Mayfair\n130    130                        McKinley Park\n131    131                        Merchant Park\n132    132                            Montclare\n133    133                          Morgan Park\n134    134                      Mount Greenwood\n135    135                        Museum Campus\n136    136                         New Eastside\n137    137                      Near North Side\n138    138                       Near West Side\n139    139                        New Chinatown\n140    140                             New City\n141    141                         Noble Square\n142    142                         North Austin\n143    143                         North Center\n144    144                        North Halsted\n145    145                        North Kenwood\n146    146                       North Lawndale\n147    147                        North Mayfair\n148    148                           North Park\n149    149                              Nortown\n150    150                    Norwood Park East\n151    151                    Norwood Park West\n152    152                              Oakland\n153    153                               O'Hare\n154    154                        Old Edgebrook\n155    155                      Old Irving Park\n156    156                          Old Norwood\n157    157                             Old Town\n158    158                    Old Town Triangle\n159    159                          Oriole Park\n160    160                        Palmer Square\n161    161                           Park Manor\n162    162                            Park West\n163    163                             Parkview\n164    164                        Peterson Park\n165    165                            Pill Hill\n166    166                               Pilsen\n167    167                      Polish Downtown\n168    168                       Polish Village\n169    169                         Portage Park\n170    170     Prairie Avenue Historic District\n171    171                       Prairie Shores\n172    172                       Princeton Park\n173    173                        Printer's Row\n174    174                         Pulaski Park\n175    175                              Pullman\n176    176                       Ranch Triangle\n177    177                           Ravenswood\n178    178                   Ravenswood Gardens\n179    179                     Ravenswood Manor\n180    180                          River North\n181    181                           River West\n182    182                         River's Edge\n183    183                            Riverdale\n184    184                          Rogers Park\n185    185                       Roscoe Village\n186    186                             Rosehill\n187    187                             Roseland\n188    188                             Rosemoor\n189    189                          Saint Ben's\n190    190                            Sauganash\n191    191                 Schorsch Forest View\n192    192                     Schorsch Village\n193    193                           Scottsdale\n194    194                  Sheffield Neighbors\n195    195                        Sheridan Park\n196    196            Sheridan Station Corridor\n197    197                        Sleepy Hollow\n198    198                           Smith Park\n199    199                         South Austin\n200    200                        South Chicago\n201    201                        South Commons\n202    202                        South Deering\n203    203                South East Ravenswood\n204    204                      South Edgebrook\n205    205                       South Lawndale\n206    206                           South Loop\n207    207                          South Shore\n208    208                     Stateway Gardens\n209    209                    Stony Island Park\n210    210                        Streeterville\n211    211                      Talley's Corner\n212    212                           Tri-Taylor\n213    213                    Ukrainian Village\n214    214                          Union Ridge\n215    215                   University Village\n216    216                               Uptown\n217    217                            The Villa\n218    218                          Vittum Park\n219    219                            Wac\u0142awowo\n220    220                   Washington Heights\n221    221                      Washington Park\n222    222                    Wentworth Gardens\n223    223                         West Beverly\n224    224                         West Chatham\n225    225                    West Chesterfield\n226    226                          West DePaul\n227    227                          West Elsdon\n228    228                       West Englewood\n229    229                   West Garfield Park\n230    230                   West Humboldt Park\n231    231                        West Lakeview\n232    232                            West Lawn\n233    233                            West Loop\n234    234                     West Morgan Park\n235    235                         West Pullman\n236    236                           West Ridge\n237    237                     West Rogers Park\n238    238                            West Town\n239    239                        West Woodlawn\n240    240                          Wicker Park\n241    241                             Wildwood\n242    242                             Woodlawn\n243    243                           Wrightwood\n244    244                 Wrightwood Neighbors\n245    245                         Wrigleyville\n"
                }
            ],
            "source": "#!pip install geocoder\n#!pip install folium\nfrom bs4 import BeautifulSoup\nimport requests\nimport pandas as pd\nimport html5lib\nimport numpy as np\nimport geocoder as ge\nimport folium\nfrom geopy.geocoders import Nominatim # convert an address into latitude and longitude values\nfrom sklearn.cluster import KMeans\nimport matplotlib.cm as cm\nimport matplotlib.colors as colors\nimport os\nimport numpy as np\n\n## You can specify any catagory here to cluster on later based on the list of the categories from FourSquare API\nrestaurant_cuisine = r\"Italian Restaurant\"\n\n\npd.set_option('display.max_columns', 999)\npd.set_option('display.max_rows', 500)\npd.set_option('display.width', 1000)\n\nradius=500\nLIMIT=100\nCLIENT_ID = 'KOZW2334OOYPKS1RF2ZGSFZPRGCRF0WNEQNQPGCKRRZWRQBI' # your Foursquare ID, this has been masked\nCLIENT_SECRET = '4L1MG2ZHVPDHICNNVRAVJVEQQKIJRTRWBPSOG1GHYESE5CF4' # youyour Foursquare Secret, this has been masked\nVERSION = '20180605' # Foursquare API version\n\nchicago_localities = \"https://en.wikipedia.org/wiki/List_of_neighborhoods_in_Chicago\"\nr = requests.get(chicago_localities)\nsoup = BeautifulSoup(r.content,'html.parser')\ntable = soup.find('table')\nneighborhoodList = []\ndfs = pd.read_html(str(table))\n\n\ndf = pd.DataFrame(dfs[0]).drop(['Community area'],axis=1).reset_index()\n# df = df[:10]\nprint (df)"
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "                                 1. create a function get_lat_and_lang to get co ordinates for all 246 neighborhoods \n                                 2. Draw chicago map using Folium package\n                                 3. get venues for all neighborhoods using FourSquare API\n                                 4. Store al the chicago venues in chicago_venues (around 6339 venues for all 246 localities)"
        },
        {
            "cell_type": "code",
            "execution_count": 37,
            "metadata": {},
            "outputs": [
                {
                    "name": "stdout",
                    "output_type": "stream",
                    "text": "The geograpical coordinate of Chicago, USA are 41.8755616, -87.6244212.\n  Neighborhood  Neighborhood Latitude  Neighborhood Longitude                     Venue  Venue Latitude  Venue Longitude      Venue Category\n0  Albany Park               41.96829               -87.72338      Lawrence Fish Market       41.968280       -87.726250  Seafood Restaurant\n1  Albany Park               41.96829               -87.72338  Chicago Kalbi Korean BBQ       41.968314       -87.722771   Korean Restaurant\n2  Albany Park               41.96829               -87.72338         El Gallo Bravo #6       41.968324       -87.721338  Mexican Restaurant\n3  Albany Park               41.96829               -87.72338                 Starbucks       41.968911       -87.728817         Coffee Shop\n4  Albany Park               41.96829               -87.72338               Rojo Gusano       41.968425       -87.724549          Taco Place\n"
                }
            ],
            "source": "\n# function to get coordinates\ndef get_lat_and_lng(neighborhood):\n    lat_lng = None\n    # loop until you get the coordinates\n    while(lat_lng is None):\n        g = ge.arcgis('{}, Chicago, USA'.format(neighborhood))\n        lat_lng = g.latlng\n    return lat_lng\n\nlat_and_land = [ get_lat_and_lng(neighborhood) for neighborhood in df[\"Neighborhood\"].tolist() ]\n\ndf_coordinates = pd.DataFrame(lat_and_land, columns=['Latitude', 'Longitude'])\ndf['Latitude'] = df_coordinates['Latitude']\ndf['Longitude'] = df_coordinates['Longitude']\n\n\naddress = 'Chicago, USA'\ngeolocator = Nominatim(user_agent=\"ny_explorer\")\nlocation = geolocator.geocode(address)\nlatitude = location.latitude\nlongitude = location.longitude\nprint('The geograpical coordinate of Chicago, USA are {}, {}.'.format(latitude, longitude))\n\nmap_chicago = folium.Map(location=[latitude, longitude], zoom_start=10)\n\nfor lat, lng, neighborhood in zip(df['Latitude'], df['Longitude'], df['Neighborhood']):\n    label = '{}'.format(neighborhood)\n    label = folium.Popup(label, parse_html=True)\n    folium.CircleMarker(\n        [lat, lng],\n        radius=5,\n        popup=label,\n        color='blue',\n        fill=True,\n        fill_color='#3186cc',\n        fill_opacity=0.7,\n        parse_html=False).add_to(map_chicago)\n\nfolium.ColorMap(map_chicago)\n\nmap_chicago.save('map_chicago.html')\n\ndef getNearbyVenues(names, latitudes, longitudes, radius=500):\n\n    venues_list=[]\n    for name, lat, lng in zip(names, latitudes, longitudes):\n        # print(name)\n\n        # create the API request URL\n        url = 'https://api.foursquare.com/v2/venues/explore?&client_id={}&client_secret={}&v={}&ll={},{}&radius={}&limit={}'.format(\n            CLIENT_ID,\n            CLIENT_SECRET,\n            VERSION,\n            lat,\n            lng,\n            radius,\n            LIMIT)\n\n        # make the GET request\n        results = requests.get(url).json()[\"response\"]['groups'][0]['items']\n\n        # return only relevant information for each nearby venue\n        venues_list.append([(\n                                name,\n                                lat,\n                                lng,\n                                v['venue']['name'],\n                                v['venue']['location']['lat'],\n                                v['venue']['location']['lng'],\n                                v['venue']['categories'][0]['name']) for v in results])\n\n    nearby_venues = pd.DataFrame([item for venue_list in venues_list for item in venue_list])\n    nearby_venues.columns = ['Neighborhood',\n                             'Neighborhood Latitude',\n                             'Neighborhood Longitude',\n                             'Venue',\n                             'Venue Latitude',\n                             'Venue Longitude',\n                             'Venue Category']\n\n    return(nearby_venues)\n\nchicago_venues = getNearbyVenues(names = df['Neighborhood'],\n                                 latitudes = df['Latitude'],\n                                 longitudes =  df['Longitude']\n                                 )\nprint(chicago_venues.head())\n\n"
        },
        {
            "cell_type": "raw",
            "metadata": {},
            "source": "#                                                      1. get all venue cateogries for all localities \n                                                       2.Get of frequency of occurances of italian restaurants in each locality"
        },
        {
            "cell_type": "code",
            "execution_count": 38,
            "metadata": {},
            "outputs": [
                {
                    "name": "stdout",
                    "output_type": "stream",
                    "text": "There are 364 uniques categories.\n      Neighborhood  Italian Restaurant\n0      Albany Park            0.000000\n1  Altgeld Gardens            0.000000\n2    Andersonville            0.035714\n3   Archer Heights            0.000000\n4    Armour Square            0.052632\n\n##############################\n\n['Seafood Restaurant' 'Korean Restaurant' 'Mexican Restaurant'\n 'Coffee Shop' 'Taco Place' 'Discount Store' 'Pet Store'\n 'Fried Chicken Joint' 'Dive Bar' 'Pharmacy' 'Mobile Phone Shop'\n 'Cosmetics Shop' 'Bank' 'Fast Food Restaurant' 'Park' 'Hookah Bar'\n 'Bakery' 'Karaoke Bar' 'Grocery Store' 'Bus Station'\n 'Financial or Legal Service' 'Pie Shop' 'Italian Restaurant'\n 'Thrift / Vintage Store' 'Breakfast Spot' 'Caf\u00e9'\n 'Southern / Soul Food Restaurant' 'Lounge' 'Ice Cream Shop'\n 'Salon / Barbershop' 'Greek Restaurant' 'Sandwich Place' 'Comic Shop'\n 'Whisky Bar' 'New American Restaurant' 'Irish Pub' 'Miscellaneous Shop'\n 'Restaurant' 'Burger Joint' 'Gym' 'Mediterranean Restaurant' 'Bookstore'\n 'Nail Salon' 'Frozen Yogurt Shop' 'Deli / Bodega' 'Pizza Place'\n 'Middle Eastern Restaurant' 'Sculpture Garden' 'Optical Shop' 'Museum'\n 'Sushi Restaurant' 'Bar' 'Wine Shop' 'Antique Shop' 'Farmers Market'\n 'Asian Restaurant' 'Scandinavian Restaurant' 'Wings Joint'\n 'Big Box Store' 'Gym / Fitness Center' 'Video Store' 'Gas Station'\n 'Hot Dog Joint' 'Chinese Restaurant' 'Clothing Store'\n 'College Rec Center' 'Sports Bar' 'Historic Site' 'American Restaurant'\n 'Intersection' 'Light Rail Station' 'Automotive Shop'\n 'Construction & Landscaping' 'Pool' 'Basketball Court' 'Boutique' 'Diner'\n 'Cajun / Creole Restaurant' 'Home Service' 'ATM' 'Supermarket' 'Brewery'\n 'Food Truck' 'Donut Shop' 'Dance Studio' 'Storage Facility'\n 'Rental Car Location' 'Electronics Store' 'Train Station' 'Soccer Field'\n 'Bus Line' 'BBQ Joint' 'Latin American Restaurant' 'Thai Restaurant'\n 'Convenience Store' 'Health & Beauty Service' 'Empanada Restaurant'\n 'Insurance Office' 'Farm' 'Accessories Store' 'Shoe Store' 'Liquor Store'\n 'Butcher' 'Gift Shop' 'Other Nightlife' 'Golf Course' 'Currency Exchange'\n 'Tanning Salon' 'Nature Preserve' 'Trail' 'River' 'Platform'\n 'Flower Shop' 'Record Shop' 'Skating Rink' 'Snack Place' 'Playground'\n 'Theater' 'Gastropub' 'Public Art' 'Plaza' 'Cuban Restaurant'\n 'Polish Restaurant' 'Pub' 'Falafel Restaurant' 'Vietnamese Restaurant'\n 'Paper / Office Supplies Store' 'Steakhouse'\n 'Vegetarian / Vegan Restaurant' 'Indian Restaurant' 'Chocolate Shop'\n 'Burrito Place' 'Arcade' 'General Entertainment' 'Hotel' 'Salad Place'\n 'Cycle Studio' 'French Restaurant' 'Indie Movie Theater' 'Food Court'\n 'Toy / Game Store' 'Market' 'Outdoor Sculpture'\n 'South American Restaurant' 'Cocktail Bar' 'Tea Room'\n 'Performing Arts Venue' 'Shoe Repair' 'Opera House' 'Movie Theater'\n 'Business Service' 'Bagel Shop' 'Shipping Store'\n 'Comfort Food Restaurant' 'Baseball Field' 'Sporting Goods Shop' 'Lawyer'\n 'Nightclub' 'Shopping Plaza' 'Dessert Shop' 'Motorcycle Shop'\n 'Supplement Shop' 'Video Game Store' 'Hardware Store' 'Mattress Store'\n 'Shopping Mall' \"Women's Store\" 'Department Store' 'Costume Shop'\n 'Art Gallery' 'Tex-Mex Restaurant' 'Japanese Restaurant'\n 'Check Cashing Service' 'Food' 'Motel' 'Yoga Studio' 'Kids Store'\n 'Lingerie Store' 'Spa' 'Tattoo Parlor' 'Massage Studio'\n 'Weight Loss Center' 'Dog Run' 'Smoke Shop' 'Beach' 'Hobby Shop'\n 'Food Service' 'College Stadium' 'Stadium' \"Doctor's Office\"\n 'Bowling Alley' 'Airport Terminal' 'Airport' 'Fish & Chips Shop'\n 'Ramen Restaurant' 'Dim Sum Restaurant' 'Juice Bar'\n 'Taiwanese Restaurant' 'Bubble Tea Shop' 'Candy Store'\n 'Hotpot Restaurant' 'Field' 'Athletics & Sports' 'Harbor / Marina'\n 'Heliport' 'Event Service' 'Jazz Club' 'Music Venue'\n 'Arts & Crafts Store' 'Pet Service' 'Tapas Restaurant' 'Building'\n 'Hostel' 'Hotel Bar' 'Portuguese Restaurant' 'Multiplex' 'Fountain'\n 'Furniture / Home Store' 'Art Museum' 'Garden' 'Indoor Play Area'\n 'Scenic Lookout' 'Caribbean Restaurant' 'Other Great Outdoors'\n 'Rock Club' 'Music Store' 'Beer Bar' 'Health Food Store'\n 'Food & Drink Shop' 'Speakeasy' 'German Restaurant' 'Smoothie Shop'\n 'Argentinian Restaurant' 'Ethiopian Restaurant' 'Garden Center'\n 'Wine Bar' 'Jewelry Store' 'Lighthouse' 'Bike Rental / Bike Share'\n 'Volleyball Court' 'Gay Bar' 'Martial Arts Dojo' 'Tennis Court'\n 'Neighborhood' 'Tailor Shop' 'Bus Stop' 'Recreation Center'\n 'Noodle House' 'Airport Lounge' 'Spanish Restaurant' 'Shop & Service'\n \"Men's Store\" 'Cupcake Shop' 'History Museum' 'Comedy Club'\n 'Moving Target' 'Indie Theater' 'Arts & Entertainment' 'Boxing Gym'\n 'Climbing Gym' 'Eastern European Restaurant' 'Boat or Ferry' 'Skate Park'\n 'Food Stand' 'Lake' 'Office' 'Distillery' 'Train' 'Eye Doctor'\n 'College Cafeteria' 'Hockey Arena' 'Brazilian Restaurant' 'Circus'\n 'Auto Dealership' 'Border Crossing' 'Water Park' 'Gymnastics Gym'\n 'Flea Market' 'Filipino Restaurant' 'Concert Hall' 'Print Shop'\n 'Street Art' 'Malay Restaurant' 'Bike Shop' 'Track' 'Camera Store'\n 'Metro Station' 'African Restaurant' 'Laundromat' 'Locksmith'\n 'Design Studio' 'Poke Place' 'Tour Provider' 'Gourmet Shop' 'Exhibit'\n 'Waterfront' 'Amphitheater' 'Monument / Landmark' 'Dumpling Restaurant'\n 'Photography Studio' 'Child Care Service' 'Indonesian Restaurant'\n 'Baby Store' 'Russian Restaurant' 'Football Stadium'\n 'Peruvian Restaurant' 'Elementary School' 'Road' 'Kitchen Supply Store'\n 'Fish Market' 'Casino' 'Community Center' 'Tiki Bar' 'Dry Cleaner'\n 'Parking' 'College Gym' 'Beer Garden' 'Beer Store' 'Bistro'\n 'Medical Center' 'Molecular Gastronomy Restaurant' 'Forest'\n 'College Bookstore' 'College Quad' 'Pakistani Restaurant' 'Music School'\n 'Airport Service' 'Tunnel' 'Rental Service' 'Mini Golf'\n 'Moroccan Restaurant' 'Other Repair Shop' 'Turkish Restaurant' 'Gym Pool'\n 'Bed & Breakfast' 'Roof Deck' 'Sake Bar' 'National Park' 'Board Shop'\n 'Non-Profit' 'Resort' 'Entertainment Service' 'Bike Trail'\n 'Mac & Cheese Joint' \"Dentist's Office\" 'Outlet Store' 'Theme Restaurant'\n 'Czech Restaurant' 'Ukrainian Restaurant' 'Cafeteria' 'Baseball Stadium'\n 'Residential Building (Apartment / Condo)' 'Hawaiian Restaurant'\n 'IT Services' 'Stationery Store' 'Science Museum' 'Creperie'\n 'Zoo Exhibit' 'Pool Hall' 'Fruit & Vegetable Store' 'Afghan Restaurant'\n 'Burmese Restaurant' 'Outdoors & Recreation' 'Leather Goods Store']\n"
                }
            ],
            "source": "\nchicago_restaurant_venues = chicago_venues[chicago_venues['Venue Category'].str.contains(\"Restaurant\")]\n\n## Count venues by each Neighborhood\nchicago_venues.groupby('Neighborhood').count()\n\nchicago_restaurant_venues.groupby('Neighborhood').count()\n\n##count unique categories\nprint('There are {} uniques categories.'.format(len(chicago_venues['Venue Category'].unique())))\n\n\n# one hot encoding\nchicago_onehot = pd.get_dummies(chicago_venues[['Venue Category']], prefix=\"\", prefix_sep=\"\")\n\n# add neighborhood column back to dataframe\nchicago_onehot['Neighborhood'] = chicago_venues['Neighborhood']\nchicago_grouped = chicago_onehot.groupby('Neighborhood').mean().reset_index()\nchicago_restaurant = chicago_grouped[[\"Neighborhood\",restaurant_cuisine]]\n\nprint(chicago_restaurant.head())\nprint(\"\\n\"+ \"##############################\" + \"\\n\" )\nprint(chicago_venues['Venue Category'].unique())"
        },
        {
            "cell_type": "raw",
            "metadata": {},
            "source": "                                              # 1.Create 3 clusters for all 246 localities \n                                                2.Distribute all venues into these culsters "
        },
        {
            "cell_type": "code",
            "execution_count": 39,
            "metadata": {},
            "outputs": [
                {
                    "name": "stdout",
                    "output_type": "stream",
                    "text": "                            Neighborhood  Italian Restaurant  Cluster Labels  index   Latitude  Longitude\n0                            Albany Park            0.000000               0      0  41.968290 -87.723380\n153                             Old Town            0.000000               0    157  41.905390 -87.641790\n154                    Old Town Triangle            0.000000               0    158  45.372300 -92.889680\n155                          Oriole Park            0.000000               0    159  41.979030 -87.814430\n156                        Palmer Square            0.000000               0    160  41.920870 -87.704780\n157                           Park Manor            0.000000               0    161  41.770390 -87.618590\n158                            Park West            0.000000               0    162  41.912270 -88.161040\n159                             Parkview            0.117647               0    163  41.950893 -87.724646\n160                        Peterson Park            0.000000               0    164  41.985820 -87.728480\n161                            Pill Hill            0.000000               0    165  41.778639 -87.601627\n162                               Pilsen            0.000000               0    166  41.857020 -87.657590\n163                      Polish Downtown            0.000000               0    167  41.709865 -86.907808\n164                       Polish Village            0.000000               0    168  41.861917 -87.647798\n152                          Old Norwood            0.062500               0    156  41.992400 -87.799060\n165                         Portage Park            0.142857               0    169  41.957770 -87.765040\n167                       Prairie Shores            0.000000               0    171  41.816538 -87.619778\n168                       Princeton Park            0.000000               0    172  41.745680 -87.631710\n169                        Printer's Row            0.011364               0    173  41.873690 -87.629650\n170                         Pulaski Park            0.000000               0    174  41.906370 -87.663920\n171                              Pullman            0.000000               0    175  41.692820 -87.605760\n172                           Ravenswood            0.022727               0    177  41.966920 -87.667060\n173                   Ravenswood Gardens            0.000000               0    178  42.007122 -87.675720\n174                     Ravenswood Manor            0.000000               0    179  42.007122 -87.675720\n175                          River North            0.070000               0    180  41.892520 -87.624770\n176                           River West            0.000000               0    181  41.948787 -87.855967\n177                         River's Edge            0.000000               0    182  41.976219 -87.733236\n178                            Riverdale            0.000000               0    183  41.653849 -87.609654\n166     Prairie Avenue Historic District            0.028571               0    170  41.856420 -87.620880\n179                          Rogers Park            0.033333               0    184  42.008850 -87.666180\n151                      Old Irving Park            0.000000               0    155  41.953550 -87.735680\n149                              Oakland            0.000000               0    152  41.824960 -87.605650\n123                      Marshall Square            0.000000               0    127  41.851993 -87.699064\n124                             Marynook            0.000000               0    128  41.846188 -87.653358\n125                              Mayfair            0.000000               0    129  41.967930 -87.737880\n126                        McKinley Park            0.000000               0    130  41.828570 -87.673380\n127                        Merchant Park            0.035714               0    131  41.927930 -87.706450\n128                            Montclare            0.000000               0    132  41.929020 -87.798470\n129                          Morgan Park            0.000000               0    133  41.690390 -87.665990\n130                      Mount Greenwood            0.000000               0    134  41.691450 -87.708300\n131                        Museum Campus            0.000000               0    135  41.858407 -87.614530\n132                      Near North Side            0.029412               0    137  41.900210 -87.634330\n133                       Near West Side            0.000000               0    138  41.873010 -87.676130\n134                        New Chinatown            0.000000               0    139  41.852760 -87.632320\n150                        Old Edgebrook            0.045455               0    154  41.997320 -87.764230\n135                             New City            0.040000               0    140  41.884250 -87.632450\n137                         Noble Square            0.000000               0    141  41.903400 -87.664510\n138                         North Austin            0.000000               0    142  41.901946 -87.775346\n139                         North Center            0.000000               0    143  41.954110 -87.681420\n140                        North Halsted            0.040000               0    144  41.885386 -87.647449\n141                        North Kenwood            0.000000               0    145  41.724988 -87.591244\n142                       North Lawndale            0.000000               0    146  41.909028 -87.719224\n143                        North Mayfair            0.000000               0    147  41.973510 -87.742160\n144                           North Park            0.000000               0    148  41.982940 -87.719150\n145                              Nortown            0.000000               0    149  41.995600 -87.699550\n146                    Norwood Park East            0.000000               0    150  41.989555 -87.818682\n147                    Norwood Park West            0.000000               0    151  41.989555 -87.818682\n148                               O'Hare            0.011905               0    153  41.979590 -87.904460\n136                         New Eastside            0.000000               0    136  41.712070 -87.530680\n180                       Roscoe Village            0.020408               0    185  41.944590 -87.678490\n181                             Rosehill            0.035714               0    186  41.986693 -87.672665\n182                             Roseland            0.000000               0    187  41.702110 -87.625740\n214                   University Village            0.000000               0    215  41.718529 -87.595898\n215                               Uptown            0.032258               0    216  41.965380 -87.669360\n216                          Vittum Park            0.000000               0    218  41.802090 -87.748570\n217                            Wac\u0142awowo            0.040000               0    219  41.884250 -87.632450\n218                   Washington Heights            0.000000               0    220  41.715840 -87.648840\n219                      Washington Park            0.000000               0    221  41.791410 -87.622390\n220                    Wentworth Gardens            0.000000               0    222  41.783372 -87.630199\n222                         West Chatham            0.000000               0    224  41.741080 -87.613030\n223                          West DePaul            0.040000               0    226  41.879420 -87.633130\n224                          West Elsdon            0.000000               0    227  41.791400 -87.723410\n225                       West Englewood            0.000000               0    228  41.777580 -87.667260\n226                   West Garfield Park            0.000000               0    229  41.877020 -87.730740\n213                          Union Ridge            0.000000               0    214  41.645701 -87.638922\n227                   West Humboldt Park            0.000000               0    230  41.910302 -87.701870\n229                            West Lawn            0.000000               0    232  41.773150 -87.724450\n230                            West Loop            0.060000               0    233  41.883040 -87.653350\n231                     West Morgan Park            0.000000               0    234  41.667416 -87.646459\n232                         West Pullman            0.000000               0    235  41.679510 -87.641890\n233                           West Ridge            0.000000               0    236  41.999480 -87.692660\n234                     West Rogers Park            0.000000               0    237  41.997680 -87.694140\n235                            West Town            0.022222               0    238  41.893290 -87.657430\n236                        West Woodlawn            0.000000               0    239  41.718548 -87.594670\n237                          Wicker Park            0.000000               0    240  41.910360 -87.682960\n238                             Wildwood            0.000000               0    241  42.001350 -87.775370\n239                             Woodlawn            0.000000               0    242  41.780460 -87.601350\n240                           Wrightwood            0.000000               0    243  41.928974 -87.656222\n228                        West Lakeview            0.038961               0    231  41.926541 -87.639151\n212                    Ukrainian Village            0.050000               0    213  41.899020 -87.682040\n211                           Tri-Taylor            0.050000               0    212  41.869323 -87.686118\n210                            The Villa            0.012048               0    217  41.903330 -87.667290\n183                             Rosemoor            0.019231               0    188  41.973512 -87.865461\n184                          Saint Ben's            0.040000               0    189  41.884250 -87.632450\n185                            Sauganash            0.000000               0    190  41.989970 -87.742270\n186                 Schorsch Forest View            0.000000               0    191  41.940459 -87.791650\n187                     Schorsch Village            0.000000               0    192  41.940459 -87.791650\n188                           Scottsdale            0.000000               0    193  41.745650 -87.732240\n189                  Sheffield Neighbors            0.022222               0    194  41.921664 -87.653488\n190                        Sheridan Park            0.081081               0    195  41.870150 -87.654250\n191            Sheridan Station Corridor            0.000000               0    196  41.998248 -87.658104\n192                        Sleepy Hollow            0.000000               0    197  41.085250 -73.859240\n193                           Smith Park            0.000000               0    198  41.892410 -87.691670\n194                         South Austin            0.000000               0    199  41.788290 -87.771915\n195                        South Chicago            0.142857               0    200  41.737320 -87.555320\n196                        South Commons            0.045455               0    201  41.964440 -87.837838\n197                        South Deering            0.000000               0    202  41.696590 -87.559510\n198                South East Ravenswood            0.022727               0    203  41.966920 -87.667060\n199                      South Edgebrook            0.000000               0    204  42.002733 -87.775847\n200                       South Lawndale            0.000000               0    205  41.847968 -87.717329\n201                           South Loop            0.010000               0    206  41.874540 -87.628840\n202                          South Shore            0.000000               0    207  41.761580 -87.578020\n203                     Stateway Gardens            0.000000               0    208  41.829760 -87.627830\n204                    Stony Island Park            0.000000               0    209  41.735310 -87.574490\n205                        Streeterville            0.040000               0    210  41.898430 -87.621410\n206                      Talley's Corner            0.000000               0    211  39.808120 -75.512510\n207                              The Gap            0.021739               0     71  41.943940 -87.663940\n208                           The Island            0.000000               0     96  41.656598 -87.726240\n209                             The Loop            0.018519               0    121  41.878340 -87.619970\n122                       Marquette Park            0.000000               0    126  41.771430 -87.702990\n241                 Wrightwood Neighbors            0.000000               0    244  41.928974 -87.656222\n121                         Margate Park            0.000000               0    125  41.972497 -87.652461\n119                               Loyola            0.000000               0    123  42.001550 -87.658641\n33                           Canaryville            0.000000               0     33  41.816940 -87.640870\n34                       Central Station            0.000000               0     34  41.790602 -87.762191\n35                               Chatham            0.000000               0     35  41.741080 -87.613030\n36                          Chicago Lawn            0.000000               0     36  41.775430 -87.696340\n37                             Chinatown            0.000000               0     37  41.852770 -87.634990\n38                      Chrysler Village            0.000000               0     38  41.759990 -87.683390\n39                        Clarendon Park            0.000000               0     39  41.963070 -87.649920\n40                         Clearing East            0.000000               0     40  41.778090 -87.759780\n41                         Clearing West            0.000000               0     41  41.778090 -87.759780\n42                 Cottage Grove Heights            0.000000               0     42  41.700089 -87.608194\n43                                Cragin            0.000000               0     43  41.919550 -87.756010\n44                             Crestline            0.000000               0     44  41.744277 -87.725216\n45                        Dearborn Homes            0.000000               0     45  41.843090 -87.627830\n46                         Dearborn Park            0.015625               0     46  41.872270 -87.628690\n47                          Douglas Park            0.000000               0     47  41.863150 -87.696890\n48                               Dunning            0.000000               0     48  41.952740 -87.796510\n50                          East Chatham            0.000000               0     50  41.741080 -87.613030\n51                    East Garfield Park            0.000000               0     51  41.878630 -87.705140\n52                        East Hyde Park            0.000000               0     52  41.802391 -87.595047\n53                           East Pilsen            0.000000               0     53  41.857020 -87.657590\n54                             East Side            0.000000               0     54  41.712070 -87.530680\n55                          East Village            0.000000               0     55  41.899640 -87.672430\n56                            Eden Green            0.000000               0     56  42.011880 -87.699740\n57                             Edgebrook            0.045455               0     57  41.997320 -87.764230\n58                             Edgewater            0.024390               0     58  41.985710 -87.663460\n32                       Calumet Heights            0.000000               0     32  41.733360 -87.577420\n31                         Cabrini\u2013Green            0.069767               0     31  41.871425 -87.653740\n30                              Burnside            0.000000               0     30  41.720310 -87.597500\n29                            Buena Park            0.000000               0     29  41.958448 -87.652662\n1                        Altgeld Gardens            0.000000               0      1  41.654410 -87.602250\n2                          Andersonville            0.035714               0      2  41.980460 -87.668340\n3                         Archer Heights            0.000000               0      3  41.811540 -87.725560\n4                          Armour Square            0.052632               0      4  41.834580 -87.631890\n5                                Ashburn            0.200000               0      5  41.747850 -87.709950\n6                        Ashburn Estates            0.000000               0      6  41.941674 -88.198809\n7                         Auburn Gresham            0.000000               0      7  41.743190 -87.655040\n8                            Avalon Park            0.000000               0      8  41.745070 -87.588160\n9                               Avondale            0.000000               0      9  41.939250 -87.711250\n10                      Avondale Gardens            0.117647               0     10  41.948461 -87.723240\n11                     Back of the Yards            0.000000               0     11  41.810450 -87.662740\n12                       Belmont Central            0.000000               0     12  41.927460 -87.777340\n120                     Magnificent Mile            0.040000               0    124  41.900580 -87.624210\n13                       Belmont Gardens            0.000000               0     13  41.937658 -87.831397\n15                       Belmont Terrace            0.000000               0     15  41.937658 -87.831397\n16                               Beverly            0.000000               0     16  41.715630 -87.672810\n18                         Beverly Woods            0.000000               0     18  41.683680 -87.680930\n19                              Big Oaks            0.040000               0     19  41.884250 -87.632450\n20                           Bowmanville            0.000000               0     21  41.979725 -87.683941\n21                              Boystown            0.000000               0     20  41.261654 -96.089780\n22                              Brainerd            0.000000               0     22  41.733390 -87.658120\n23                             Brickyard            0.000000               0     23  41.929190 -87.786000\n24                            Bridgeport            0.000000               0     24  41.837980 -87.650900\n25                         Brighton Park            0.000000               0     25  41.818610 -87.699480\n26                           Bronzeville            0.100000               0     26  41.823740 -87.623640\n27                              Bucktown            0.000000               0     27  41.917850 -87.672870\n14                       Belmont Heights            0.000000               0     14  41.937658 -87.831397\n60                        Edgewater Glen            0.019231               0     60  41.986198 -87.669396\n59                       Edgewater Beach            0.020408               0     59  41.987360 -87.655230\n62                             Englewood            0.000000               0     62  41.779780 -87.645130\n93                          Irving Woods            0.000000               0     95  45.685949 -92.972610\n94                               Jackowo            0.040000               0     97  41.884250 -87.632450\n95                Jackson Park Highlands            0.000000               0     98  41.771420 -87.578940\n96                        Jefferson Park            0.000000               0     99  41.970540 -87.763290\n97                                K-Town            0.018519               0    100  41.921850 -87.697350\n98                           Kelvyn Park            0.000000               0    101  41.928660 -87.737720\n99                          Kennedy Park            0.000000               0    102  41.688110 -87.683610\n100                           Kensington            0.000000               0    103  41.681090 -87.607000\n101                              Kenwood            0.000000               0    104  41.809520 -87.596820\n102                        Kilbourn Park            0.000000               0    105  41.944460 -87.739610\n103                      Kosciuszko Park            0.000000               0    106  41.930040 -87.724530\n104                         Lake Meadows            0.000000               0    107  41.959893 -87.659425\n61                           Edison Park            0.000000               0     61  42.007890 -87.813990\n105                            Lake View            0.017241               0    108  41.939820 -87.656820\n107                  Lakewood / Balmoral            0.000000               0    110  40.036011 -74.161368\n108                      LeClaire Courts            0.000000               0    111  41.907717 -87.753429\n109  Legends South (Robert Taylor Homes)            0.000000               0    112  39.297364 -80.183363\n110                             Lilydale            0.000000               0    113  41.724200 -87.625330\n111                         Lincoln Park            0.015385               0    114  41.921840 -87.647440\n112                       Lincoln Square            0.021739               0    115  41.975800 -87.689140\n113                     Lithuanian Plaza            0.000000               0    116  41.768271 -87.688249\n114                         Little Italy            0.100000               0    117  28.185770 -82.411790\n115                       Little Village            0.000000               0    118  41.844440 -87.711430\n116                         Logan Square            0.000000               0    119  41.923280 -87.698100\n117                       Longwood Manor            0.000000               0    120  41.699071 -87.671246\n118                      Lower West Side            0.000000               0    122  41.852240 -87.671150\n106                       Lake View East            0.000000               0    109  41.885757 -87.624328\n91             Illinois Medical District            0.000000               0     93  41.875570 -87.676520\n92                           Irving Park            0.000000               0     94  41.953550 -87.735680\n89                         Humboldt Park            0.000000               0     91  41.899070 -87.719470\n63                              Fernwood            0.000000               0     63  45.390378 -92.991010\n64                            Fifth City            0.000000               0     64  45.511605 -92.975863\n65                             Ford City            0.000000               0     65  41.753178 -87.732241\n66                           Forest Glen            0.000000               0     66  41.976400 -87.753610\n67                           Fuller Park            0.000000               0     67  41.812530 -87.632620\n68                 Fulton River District            0.000000               0     68  33.992210 -84.187080\n69                             Gage Park            0.000000               0     69  41.793650 -87.695610\n70                              Galewood            0.000000               0     70  41.912720 -87.789170\n71                        Garfield Ridge            0.000000               0     72  41.790750 -87.770140\n72                        Gladstone Park            0.000000               0     73  41.979010 -87.773230\n73                            Gold Coast            0.050000               0     74  41.903950 -87.628860\n74                           Golden Gate            0.000000               0     75  45.586512 -92.972298\n75                        Graceland West            0.000000               0     77  41.957230 -87.662275\n90                             Hyde Park            0.000000               0     92  41.793880 -87.593260\n76                       Grand Boulevard            0.000000               0     78  41.809310 -87.621420\n83                           Hanson Park            0.000000               0     85  41.921140 -87.763390\n88                          Homan Square            0.000000               0     90  41.664258 -87.704664\n87                        Hollywood Park            0.050000               0     89  41.989300 -87.710730\n86                               Hermosa            0.000000               0     88  41.928480 -87.734240\n85                             Hegewisch            0.000000               0     87  41.653680 -87.546220\n84                      Heart of Chicago            0.000000               0     86  41.889253 -87.675384\n77                        Grand Crossing            0.000000               0     79  41.755900 -87.599230\n242                         Wrigleyville            0.000000               0    245  41.947250 -87.653200\n81                        Groveland Park            0.000000               0     83  41.833640 -87.610330\n80                               Gresham            0.000000               0     82  41.935957 -87.714609\n79                             Greektown            0.022727               0     81  41.877770 -87.647250\n78                Greater Grand Crossing            0.000000               0     80  41.762060 -87.614580\n82                         Hamilton Park            0.000000               0     84  41.763460 -87.637440\n"
                }
            ],
            "source": "kclusters = 3\nchicago_clustering = chicago_grouped.drop('Neighborhood', 1)\n\n\n# run k-means clustering\nkmeans = KMeans(n_clusters=kclusters, random_state=0).fit(chicago_clustering)\n\n# check cluster labels generated for each row in the dataframe\nkmeans.labels_[0:10]\nchicago_merged = chicago_restaurant.copy()\nchicago_merged[\"Cluster Labels\"] = kmeans.labels_\n\n\n# merge chicago_merged with chicago to add latitude/longitude for each neighborhood\nchicago_merged = chicago_merged.join(df.set_index('Neighborhood'), on='Neighborhood')\nchicago_merged.head() # check the last columns!\nchicago_merged.sort_values([\"Cluster Labels\"], inplace=True)\n\n\n# create map\nmap_clusters = folium.Map(location=[latitude, longitude], zoom_start=11)\n\n# set color scheme for the clusters\nx = np.arange(kclusters)\nys = [i + x + (i*x)**2 for i in range(kclusters)]\ncolors_array = cm.rainbow(np.linspace(0, 1, len(ys)))\nrainbow = [colors.rgb2hex(i) for i in colors_array]\n\n# add markers to the map\nmarkers_colors = []\nfor lat, lon, poi, cluster in zip(chicago_merged['Latitude'], chicago_merged['Longitude'], chicago_merged['Neighborhood'], chicago_merged['Cluster Labels']):\n    label = folium.Popup(str(poi) + ' Cluster ' + str(cluster), parse_html=True)\n    folium.CircleMarker(\n        [lat, lon],\n        radius=5,\n        popup=label,\n        color=rainbow[cluster-1],\n        fill=True,\n        fill_color=rainbow[cluster-1],\n        fill_opacity=0.7).add_to(map_clusters)\n\nmap_clusters\n\n## display clsuter number 1\nprint(chicago_merged.loc[chicago_merged['Cluster Labels'] == 0])\n\n\n"
        },
        {
            "cell_type": "code",
            "execution_count": 40,
            "metadata": {},
            "outputs": [
                {
                    "name": "stdout",
                    "output_type": "stream",
                    "text": "     Neighborhood  Italian Restaurant  Cluster Labels  index  Latitude  Longitude\n28  Budlong Woods                 0.0               1     28  41.18414 -83.671283\n"
                }
            ],
            "source": "print(chicago_merged.loc[chicago_merged['Cluster Labels'] == 1])\n"
        },
        {
            "cell_type": "code",
            "execution_count": 41,
            "metadata": {},
            "outputs": [
                {
                    "name": "stdout",
                    "output_type": "stream",
                    "text": "     Neighborhood  Italian Restaurant  Cluster Labels  index   Latitude  Longitude\n49   East Beverly                 0.0               2     49  41.695888  -87.64999\n221  West Beverly                 0.0               2    223  41.695888  -87.64999\n17   Beverly View                 0.0               2     17  41.695888  -87.64999\n"
                }
            ],
            "source": "print(chicago_merged.loc[chicago_merged['Cluster Labels'] == 2])\n"
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": ""
        }
    ],
    "metadata": {
        "kernelspec": {
            "display_name": "Python 3.6",
            "language": "python",
            "name": "python3"
        },
        "language_info": {
            "codemirror_mode": {
                "name": "ipython",
                "version": 3
            },
            "file_extension": ".py",
            "mimetype": "text/x-python",
            "name": "python",
            "nbconvert_exporter": "python",
            "pygments_lexer": "ipython3",
            "version": "3.6.8"
        }
    },
    "nbformat": 4,
    "nbformat_minor": 1
}